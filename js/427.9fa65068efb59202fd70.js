"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[427],{50427:(t,e,i)=>{i.d(e,{h:()=>v});var n=i(16926),s=i(91051),a=i(64047),r=i(57244),o=i(85775),p=i(82346),g=i(20948),h=i(56979),d=i(13964),c=i(47165),f=i(4206),l=i(30626),u=i(493),b=i(84785);const m=()=>{let t=0,e=0;try{performance.getEntriesByType("paint").forEach((i=>{"first-paint"===i.name?t=i.startTime:"first-contentful-paint"===i.name&&(e=i.startTime)}));const i=performance.getEntriesByType("navigation"),n=i.length>0?i[0].responseStart:0;return{fp:t,fcp:e,ttfb:n}}catch(i){return{fp:t,fcp:e,ttfb:0}}};let _=class{constructor(t,e,i,n){this.appContext=t,this.fetch=e,this.util=i,this.router=n,this.pageConfig={bid:u.Li,pid:""},this.initialized=!1}setBid(t){this.init(),this.pageConfig.bid=t}setPid(t){this.init(),this.pageConfig.pid=t}getPageStart(){return Number((performance.timeOrigin||performance.timing.navigationStart||Date.now()).toFixed(0))}init(){this.initialized||(this.initialized=!0,this.router.router$.subscribe((()=>{this.send("route_change")})),(0,d.G6)()?window.addEventListener("pagehide",(t=>{t.persisted||this.send("page_hide")}),!1):(0,d.Y8)((()=>{this.send("page_hide")}),(()=>{this.pageStart=Date.now()})))}send(t){this.performanceArgs||(this.performanceArgs=m()),(0,p.of)({now:Date.now(),trigger:t}).pipe((0,g.M)(this.appContext.state$),(0,h.U)((([{now:t,trigger:e},i])=>{var n,s,a,r,o,p,g;return Object.assign(Object.assign(Object.assign({},this.pageConfig),null!==(n=this.performanceArgs)&&void 0!==n?n:m()),{botType:null!==(a=null===(s=i.appContext)||void 0===s?void 0:s.botType)&&void 0!==a?a:"",isMobile:null!==(o=null===(r=i.appContext)||void 0===r?void 0:r.isMobile)&&void 0!==o&&o,isLogin:Boolean(null===(p=i.appContext)||void 0===p?void 0:p.user),timestamp:t-(null!==(g=this.pageStart)&&void 0!==g?g:this.getPageStart()),trigger_event:e})})),(0,h.U)((t=>{this.sendHeartbeat(t),this.pageStart=Date.now()})),(0,c.n)({})).subscribe()}sendHeartbeat(t){const e=`${this.util.getBaseUrl(3)}/whale/heartbeat`,i=(t=>{const e=Object.keys(t);return new URLSearchParams(e.map((e=>[e,`${t[e]}`])))})(t);"function"==typeof navigator.sendBeacon?navigator.sendBeacon(e,i):this.fetch.post(e,{body:i})}};_=(0,a.__decorate)([(0,r.G)(),(0,a.__metadata)("design:paramtypes",[b.G,f.r,l.GV,o.Bz])],_);const v=t=>{const e=(0,n.fz)(_);(0,s.useEffect)((()=>{e.setPid(t)}),[e,t])}}}]);